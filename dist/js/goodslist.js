"use strict";require.config({paths:{jquery:"../lib/jquery-1.10.1.min",common:"common"},shim:{common:{deps:["jquery"]}}}),require(["common","jquery"],function(){var o={set:function(e,n,o){var t=e+"="+n;o.expires&&(t+=";expires="+o.expires.toUTCString()),o.path&&(t+=";path="+o.path),o.domain&&(t+=";domain="+o.domain),document.cookie=t},get:function(e){for(var n=document.cookie.split("; "),o=0;o<n.length;o++){var t=n[o].split("=");if(e==t[0])return t[1]}},remove:function(e){var n=new Date;n.setDate(n.getDate()-1),o.set(e,"",{expires:n,path:"/"})}};updateCartStyle(),$("#downDrag").on("mouseenter",function(){$(".down").css("display","block")}),$("#downDrag").on("mouseleave",function(){$(".down").css("display","none")}),$(".more").click(function(e){$(".more").hide(),$(".hide").show(),$("#news")[0].style.display="inline-block",$("#drag")[0].style.display="inline-block",$(".lit")[0].style.display="none",$(".brand").children("span").eq(0).css({height:286})}),$(".hide").click(function(e){$(".more")[0].style.display="inline-block",$(".hide")[0].style.display="none",$("#news")[0].style.display="none",$("#drag")[0].style.display="none",$(".lit")[0].style.display="inline-block",$(".brand").children("span").eq(0).css({height:90})}),showlist(),jump();var t=[];function n(e){if($(e.target.parentElement.parentElement).toggleClass("active"),$(e.target.parentElement.parentElement).hasClass("active")){$(e.target.parentElement.parentElement).append('<i class="lf-icon lf-icon-imgchecked-o"></i>'),$(".lf-icon-imgchecked-o").css({width:"15px",height:"13px",background:"url('http://h5rsc.vipstatic.com/lefeng_pc/build/23122da223a7da5293a116c8f07f19d6.png') -128px -38px",position:"absolute",right:"0",top:"33px"});var n='<span class="cla2">'+e.target.alt+" x </span>";t.push(n)}else{$(e.target.parentElement.parentElement).children(".lf-icon-imgchecked-o").remove();n='<span class="cla2">'+e.target.alt+" x </span>";var o=t.indexOf(n);-1<o&&t.splice(o,1)}}function a(){$(".cont h4")[0].innerHTML='<span>全部</span><span class="cla" style="color: red;"><i></i>'+decodeURIComponent(location.search.slice(9))+"</span></h4>",$(".lit").children("li").css("borderColor","#eceae6"),$(".lit").children(".active").removeClass("active"),$(".lit").children("li").children(".lf-icon-imgchecked-o").remove(),$("#news").children(".content").children("li").css("borderColor","#eceae6"),$("#news").children(".content").children(".active").removeClass("active"),$("#news").children(".content").children("li").children(".lf-icon-imgchecked-o").remove()}function e(){a(),"-150px -54px"==$(".lf-icon-btn-mselect").css("backgroundPosition")?($(".lit").off("click","img"),a(),$(".lit").on("click","img",function(e){a(),e.target.parentElement.parentElement.style.borderColor="#f10180",t=[],n(e),$(".cont h4")[0].innerHTML+='<i class="arrow" style="float:left;margin: 9px 5px 0;width: 5px;height: 8px;background: url(\'../img/smallicon.png\') no-repeat -121px 0;"></i>'+t.join("")}),$("#news").off("click","img"),$("#news").on("click","img",function(e){a(),e.target.parentElement.parentElement.style.borderColor="#f10180",t=[],n(e),$(".cont h4")[0].innerHTML+='<i class="arrow" style="float:left;margin: 9px 5px 0;width: 5px;height: 8px;background: url(\'../img/smallicon.png\') no-repeat -121px 0;"></i>'+t.join("")})):"-150px -76px"==$(".lf-icon-btn-mselect").css("backgroundPosition")&&($(".lit").off("click","img"),$(".lit").on("click","img",function(e){$(".cont h4")[0].innerHTML='<span>全部</span><span class="cla" style="color: red;"><i></i>'+decodeURIComponent(location.search.slice(9))+'</span></h4><i class="arrow" style="float:left;margin: 9px 5px 0;width: 5px;height: 8px;background: url(\'../img/smallicon.png\') no-repeat -121px 0;"></i>',n(e),console.log(t),$(".cont h4")[0].innerHTML+=t.join("<span class='cla'>|</span>")}),$("#news").off("click","img"),$("#news").on("click","img",function(e){$(".cont h4")[0].innerHTML='<span>全部</span><span class="cla" style="color: red;"><i></i>'+decodeURIComponent(location.search.slice(9))+'</span></h4><i class="arrow" style="float:left;margin: 9px 5px 0;width: 5px;height: 8px;background: url(\'../img/smallicon.png\') no-repeat -121px 0;"></i>',n(e),$(".cont h4")[0].innerHTML+=t.join("<span class='cla'>|</span>")}))}e(),$(".cont").on("click",".cla2",function(){var e=t.indexOf($(this)[0].outerHTML);-1<e&&(t.splice(e,1),$(".cont h4")[0].innerHTML='<span>全部</span><span class="cla" style="color: red;"><i></i>'+decodeURIComponent(location.search.slice(9))+'</span></h4><i class="arrow" style="float:left;margin: 9px 5px 0;width: 5px;height: 8px;background: url(\'../img/smallicon.png\') no-repeat -121px 0;"></i>',$(".cont h4")[0].innerHTML+=t.join("<span class='cla'>|</span>"),$("img[alt^='"+$(this)[0].innerHTML.slice(0,-3)+"']").parent().parent().removeClass("active").css({borderColor:"rgb(236, 234, 230)"}).find(".lf-icon-imgchecked-o").remove())});var s,i=1,c="auto";function l(){$.ajax({url:"../api/4.listLoad.php",data:{page:i,type:c,keyword:decodeURIComponent(location.search.slice(9))}}).done(function(e){var n=JSON.parse(e);s=Math.ceil(n.len/n.qty);var o="";i=n.page,$("#productDivGroup").html(n.res.map(function(e){return'\n                        <li class="pruwrap" name="products" data-sid="510849978013460" data-pid="'+e.id+'" data-haitao="0" data-min="1" mars_sead="lpc_ss_sku">\n                            <dl>\n                                <dt>\n                                    <a target="_blank" title="'+e.title+'" href="javascript:;">\n                                        <img alt="" src="'+e.imgurl+'">\n                                    </a>\n                                    <div class="wraptr">\n                                        \x3c!-- 缺货商品在图片右上角显示已抢光 --\x3e\n                                    </div>\n                                    <ul class="pro-tags">\n                                        <li>补水</li>\n                                        <li>亮肤</li>\n                                        <li>保湿</li>\n                                    </ul>\n                                </dt>\n                                <dd class="nam">\n                                    <a title="'+e.title+'" target="_blank" href="javascript:;"><span>百雀羚百雀羚【控油去尘垢】三生花控油清肌净肤泥膜50g 补水面膜</span>\n                                    </a>\n                                </dd>\n                                <dd class="pri">\n                                <span class="price-tag">￥</span>\n                                <span class="price">'+e.curPri.slice(1)+"</span> \n                                <b> "+e.b+' </b>\n                                <del class="spri">'+e.oldPri+'</del>\n                                    <a class="to joinCar add-to-cart" href="javascript:;" mars_sead="lpc_ss_cart">加入购物车</a>\n                                </dd>\n                            </dl>\n                        </li>\n                    '}).join("")+'<li class="nextPageClass" name="productNext" mars_sead="lpc_ss_fy">\n                                <a href="javascript:;"></a><b>&nbsp;</b>\n                            </li>');for(var t=1;t<1*s+1;t++)o+='<a href="javascript:;" class="pageA" name="pageA">'+t+"</a>";$(".pages").html('<a class="uppage stop" name="productUpPage" href="javascript:;">&lt;</a>'+o+'<a class="downpage "  name="productDownPage">&gt;</a>'),$("i[name='productTotals']").html(n.len).next("em").html('<i name="productPageNo">'+i+"</i>/"+s+"</em>"),function(){var e=i;$(".pages").find(".pageA").eq(--e).addClass("downactive"),i==s&&($(".downpage").addClass("stop"),$(".lf-icon-right-o").addClass("fade"));i<s&&($(".downpage").removeClass("stop"),$(".lf-icon-right-o").removeClass("fade"));1<i&&($(".uppage").removeClass("stop"),$(".lf-icon-left-o").removeClass("fade"));1==i&&($(".uppage").addClass("stop"),$(".lf-icon-left-o").addClass("fade"))}()})}function r(){$(this).css("width","130px").find("a").css("display","block")}function d(){$(this).css("width","130px").find("a").css("display","none")}l(),$("body").on("click",".downpage,.nextPageClass,.lf-icon-right-o",function(){s<++i?i=s:l()}),$("body").on("click",".uppage,.lf-icon-left-o",function(){--i<1?i=1:l()}),$(".pages").on("click",".pageA",function(){i=$(this).html(),l()}),$(".order-1").on("click",function(){$(".order-2").removeClass("active").css("width","82px"),$(".order-3").removeClass("active"),$(".order-1").addClass("active"),c="auto",l(),$(".order-2").removeClass("active").find("span").html('价格<i class="lf-icon lf-icon-down"></i>'),$(".order-3").find("span").html('销量<i class="lf-icon lf-icon-down"></i>')}),$(".order-2").on("mouseover",r),$(".order-2").on("mouseout",d),$(".order-2").on("click",".btn-active-1",function(){$(".order-1").removeClass("active"),$(".order-3").removeClass("active"),c="up",l(),$(".order-2").off("mouseout",d).off("mouseover",r).find("span").html($(this).html()),$(".order-2").addClass("active").css("width","130px").find("a").css("display","none"),setTimeout(function(){$(".order-2").on("mouseover",r).on("mouseout",d)},2e3),$(".order-3").find("span").html('销量<i class="lf-icon lf-icon-down"></i>')}),$(".order-2").on("click",".btn-active-2",function(){$(".order-1").removeClass("active"),$(".order-3").removeClass("active"),c="down",l(),$(".order-2").off("mouseout",d).off("mouseover",r).find("span").html($(this).html()),$(".order-2").addClass("active").css("width","130px").find("a").css("display","none"),setTimeout(function(){$(".order-2").on("mouseover",r).on("mouseout",d)},2e3),$(".order-3").find("span").html('销量<i class="lf-icon lf-icon-down"></i>')}),$(".order-3").on("click",".btn-active-1",function(){$(".order-1").removeClass("active"),$(".order-2").removeClass("active").find("span").html('价格<i class="lf-icon lf-icon-down"></i>'),c="qtydown",l(),$(".order-3").addClass("active"),$(".order-3").find("span").html($(this).html())}),$("#inTheSale").on("click",function(){$("#inTheSale").toggleClass("c_on"),$("#inTheSale").toggleClass("c_off"),l()});var p=!0;$(".lf-icon-btn-mselect").click(function(){p?$(this).css("backgroundPosition","-150px -76px"):p||$(this).css("backgroundPosition","-150px -54px"),e(),p=!p,t=[]});var f=document.getElementsByClassName("content")[0],m=document.getElementById("news"),u=document.getElementById("drag"),h=document.getElementsByClassName("hezi")[0],g=0;function v(e,n,o,t,a){e<=0?e=0:e>=n.offsetHeight-o.offsetHeight&&(e=n.offsetHeight-o.offsetHeight);var s=e/(n.offsetHeight-o.offsetHeight);t.style.top=-s*(t.offsetHeight-a.offsetHeight)+"px",o.style.top=e+"px"}m.onmouseout=function(){window.onmousewheel=function(){return!0}},h.onmousedown=function(e){var n=(e=e||window.event).clientY-h.offsetTop;document.onmousemove=function(e){e=e||window.event;v(g=e.clientY-n,u,h,f,m)}},document.onmouseup=function(){document.onmousemove=null},function(e,o){-1!=navigator.userAgent.indexOf("Firefox")?e.addEventListener("DOMMouseScroll",n,!1):e.onmousewheel=n;function n(e){window.onmousewheel=function(){return!1};var e=e||window.event,n=!0;n=e.detail?0<e.detail:e.wheelDelta<0,o(n)}}(f,function(e){e?(v(g+=10,u,h,f,m),console.log(g)):v(g-=10,u,h,f,m),g<=0?g=0:g>=u.offsetHeight-h.offsetHeight&&(g=u.offsetHeight-h.offsetHeight)}),$("#productDivGroup").on("click","a:not(.add-to-cart)",function(){var e=$(this).closest(".pruwrap")[0].dataset.pid;$(this)[0].href="./detail.html?id="+e}),updateCartStyle(),$("#productDivGroup").on("click",".add-to-cart",function(){var e=o.get("username"),n=$(this).closest(".pruwrap")[0].dataset.pid;$.ajax({url:"../api/2.username.php",data:{username:e}}).done(function(e){1==e?$.ajax({url:"../api/6.shoppingCart.php",data:{type:"one",id:n}}).done(function(){$("#addsuccess").css({display:"block"}),$.ajax({url:"../api/6.shoppingCart.php",data:{type:"all"}}).done(function(e){console.log(e);e=JSON.parse(e);var n=0,o=0;e.map(function(e){n+=1*e.qty,o+=e.qty*e.curPri.slice(1)}),$(".sum").html("\n                                <h3>该商品已成功放入购物车</h3>\n                                <p>购物车共 <b>"+n+"</b> 件商品&nbsp;&nbsp;合计：<b>"+o+'</b> 元</p>\n                                <p><a class="pay" href="../html/buyCart.html">去结算</a><a class="close" href="javascript:;">&lt;&lt;继续购物</a></p>\n                                <span class="succ-ico"></span>\n                            '),setTimeout(function(){$("#addsuccess").css({display:"none"})},8e3)}),updateCartStyle()}):location.href="./login.html"})}),$("#addsuccess").on("click",".close,.succ-close",function(){$("#addsuccess").css({display:"none"})})});